name: Publish tag as nightly

on:
  push:
    tags: 
       - '**'

jobs:
  build:
    name: Build and Publish tag as nightly
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code ğŸ“˜
      uses: actions/checkout@v3
    - name: Set up JDK 11 â˜•
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
        cache: maven
    - name: Build âš’ï¸
      # run: mvn -B package --file releng/fr.inria.diverse.melange.releng.root/pom.xml
      run: echo "run when pushing a tag"
    - name: ssh-agent ğŸ”‘
      uses: webfactory/ssh-agent@v0.5.4
      with:
        ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}
    - name: ssh scp pipelines
      env:
        WELCOME: "ssh scp ssh pipelines"
        DEPLOYPATH: "/home/web/apache/sites/melange.inria.fr/htdocs/updatesite/nightly"
        LASTSSH: "Doing something after copying"
      run:
        ssh -o StrictHostKeyChecking=accept-new web-melange@melange.inria.fr 'pwd && ls -lsa'